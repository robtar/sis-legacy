<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"
	"http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

  <bean id="userManager" parent="txProxyTemplate">
    <property name="target">
      <bean class="cz.silesnet.service.impl.UserManagerImpl">
        <property name="userDAO">
          <ref local="userDAO" />
        </property>
        <property name="historyManager">
          <ref local="historyManager" />
        </property>
      </bean>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="insert*">PROPAGATION_REQUIRED</prop>
        <prop key="update*">PROPAGATION_REQUIRED</prop>
        <prop key="delete*">PROPAGATION_REQUIRED</prop>
        <prop key="dispatch*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="labelManager" parent="txProxyTemplate">
    <property name="target">
      <bean class="cz.silesnet.service.impl.LabelManagerImpl">
        <property name="labelDAO">
          <ref local="labelDAO" />
        </property>
      </bean>
    </property>
  </bean>

  <bean id="nodeManager" parent="txProxyTemplate">
    <property name="target">
      <bean class="cz.silesnet.service.impl.NodeManagerImpl">
        <property name="nodeDAO">
          <ref local="nodeDAO" />
        </property>
        <property name="historyManager">
          <ref local="historyManager" />
        </property>
      </bean>
    </property>
  </bean>

  <bean id="historyManager" parent="txProxyTemplate">
    <property name="target">
      <bean class="cz.silesnet.service.impl.HistoryManagerImpl">
        <property name="historyItemDAO">
          <ref local="historyItemDAO" />
        </property>
        <property name="labelManager">
          <ref local="labelManager" />
        </property>
      </bean>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="insert*">PROPAGATION_REQUIRED</prop>
        <prop key="update*">PROPAGATION_REQUIRED</prop>
        <prop key="delete*">PROPAGATION_REQUIRED</prop>
        <prop key="clear*">PROPAGATION_REQUIRED</prop>
        <prop key="remove*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="customerManager" parent="txProxyTemplate">
    <property name="target">
      <bean class="cz.silesnet.service.impl.CustomerManagerImpl">
        <property name="customerDAO">
          <ref local="customerDAO" />
        </property>
        <property name="billDAO">
          <ref local="billDAO" />
        </property>
        <property name="serviceDAO">
          <ref local="serviceDAO" />
        </property>
        <property name="historyManager">
          <ref local="historyManager" />
        </property>
        <property name="settingManager">
          <ref local="settingManager" />
        </property>
      </bean>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="insert*">PROPAGATION_REQUIRED</prop>
        <prop key="update*">PROPAGATION_REQUIRED</prop>
        <prop key="delete*">PROPAGATION_REQUIRED</prop>
        <prop key="deactivateCandidates">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>

  </bean>

  <bean id="billingManager" parent="txProxyTemplate">
    <property name="target">
      <bean class="cz.silesnet.service.impl.BillingManagerImpl">
        <property name="billDAO">
          <ref local="billDAO" />
        </property>
        <property name="customerManager">
          <ref bean="customerManager" />
        </property>
        <property name="historyManager">
          <ref local="historyManager" />
        </property>
        <property name="settingManager">
          <ref local="settingManager" />
        </property>
        <property name="mailSender">
          <ref local="mailSenderProduction" />
        </property>
        <property name="signedEmailGenerator">
          <ref local="signedEmailGenerator" />
        </property>
        <property name="emailFromAddressCs" value="${email.from.cs}" />
        <property name="emailFromAddressPl" value="${email.from.pl}" />
        <property name="emailSendingDelay" value="${email.delay}" />
      </bean>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="insert*">PROPAGATION_REQUIRED</prop>
        <prop key="update*">PROPAGATION_REQUIRED</prop>
        <prop key="delete*">PROPAGATION_REQUIRED</prop>
        <prop key="invoice*">PROPAGATION_REQUIRED</prop>
        <prop key="send*">PROPAGATION_REQUIRED</prop>
        <prop key="reSendAll">PROPAGATION_REQUIRED</prop>
        <prop key="export*">PROPAGATION_REQUIRED</prop>
        <prop key="emailAll">PROPAGATION_REQUIRED</prop>
        <prop key="setSendingEnabled">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="settingManager" parent="txProxyTemplate">
    <property name="target">
      <bean class="cz.silesnet.service.impl.SettingManagerImpl">
        <property name="settingDAO">
          <ref local="settingDAO" />
        </property>
      </bean>
    </property>
  </bean>

</beans>